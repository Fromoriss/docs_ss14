# Метаболізм

Метаболізм у SS14 дуже відрізняється від метаболізму в SS13. В SS13 реагенти просто мали функцію `on_mob_life`, яка викликалася для визначення того, що має статися. Наша система набагато більш модульна і дозволяє без проблем враховувати такі речі, як різні органи, що метаболізують різні реагенти, специфічний для окремого виду метаболізм, а також передозування або недостатнє дозування.

## Органи & Метаболізатори

В даному контексті, метаболізатори це сутності, що метаболізують (наприклад шлунок).

У SS14 органи є сутностями з компонентом `MechanismComponent` (механізм це просто загальний термін для 'органу'). Органи також мають інші компоненти, які надають їм відокремлену поведінку; `StomachComponent`, `CirculatorComponent`, `RespiratorComponent` і так далі. Однак, найважливішим тут є компонент `MetabolizerComponent`.

Метаболізатори (тобто органи з компонентом `MetabolizerComponent`) мають перелік груп метаболізму, які вони метаболізують. "Групи метаболізму" - це такі речовини, як "Наркотики", "Їжа" або "Ліки" (у коді вони визначені як 'Narcotic', 'Food', 'Medicine' відповідно). Це дозволяє нам керувати тим, як органи метаболізують різні хімічні речовини.

Наприклад це - сутність `OrganHumanStomach`. Цей запис означає, що шлунок перетравлює будь-які реагенти з типами метаболізму "Їжа" або "Напої" (відповідно `Food` та `Drink` у коді):

```yml
  - type: Metabolizer
    # а пахне як~
    maxReagents: 3
    metabolizerTypes: [Human]
    groups:
    - id: Food
    - id: Drink
```

Метаболізатори можуть переробляти лише стільки реагентів одночасно, щоб уникнути поширеної проблеми з SS13, коли накопичення тонни отрут на одному об'єкті завдало б йому значно більшої шкоди, ніж одна концентрована отрута.

Швидкість метаболізму визначається в коді органу. Як правило, це раз на секунду, і хімічні речовини беруться з кровотоку.

## Види

Визначити, який вплив мають різні хімічні речовини на різні види, досить легко. Метаболізатори мають тег "тип органу", який по суті є позначкою виду, але ця позначка прив'язана до органу (тобто, якщо ви заміните своє серце на серце горили, ви будете метаболізувати ліки/отрути/тощо, так само як це робить горила). Далі, ви можете використовувати умову `OrganType` для перевірки. Ось приклад теоброміну (хімічна речовина, що міститься у шоколаді), як його реалізовано у коді:

```yml
  metabolisms:
    Poison:
      effects:
      - !type:HealthChange
        conditions:
        - !type:ReagentThreshold
          min: 1
        - !type:OrganType
          type: Animal # Нанесення шкоди мобам з низькими можливостями до метаболізму
        damage:
          types:
            Poison: 4
```

Як випливає з коментаря, для людей ця хімічна речовина нічого не робить, але для тварин (будь-чого з органами тварин) вона може бути смертельною.